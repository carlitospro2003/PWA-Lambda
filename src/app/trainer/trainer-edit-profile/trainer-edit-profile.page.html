<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/trainer/profile"></ion-back-button>
    </ion-buttons>
    <ion-title>Editar Perfil</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="resetForm()" fill="clear" color="medium">
        <ion-icon name="refresh-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="edit-profile-content">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Editar Perfil</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="edit-profile-container">

    <!-- Avatar Section -->
    <div class="avatar-section">
      <div class="avatar-container">
        <ion-icon name="person-circle" class="avatar-icon" color="primary"></ion-icon>
        <ion-button fill="clear" size="small" color="primary" class="change-photo-btn">
          <ion-icon name="camera-outline" slot="start"></ion-icon>
          Cambiar foto
        </ion-button>
      </div>
    </div>

    <!-- Formulario de Edición -->
    <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
      
      <!-- Información Personal -->
      <ion-card class="form-card">
        <ion-card-header>
          <ion-card-title>
            <ion-icon name="person-outline" class="section-icon"></ion-icon>
            Información Personal
          </ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <ion-list>
            
            <!-- Nombre -->
            <ion-item class="form-item" [class.error]="hasError('firstName')">
              <ion-label position="stacked">Nombre *</ion-label>
              <ion-input 
                formControlName="firstName"
                placeholder="Ingresa tu nombre"
                clearInput="true">
              </ion-input>
              <div class="error-message" *ngIf="hasError('firstName')">
                {{ getErrorMessage('firstName') }}
              </div>
            </ion-item>

            <!-- Apellidos -->
            <ion-item class="form-item" [class.error]="hasError('lastName')">
              <ion-label position="stacked">Apellidos *</ion-label>
              <ion-input 
                formControlName="lastName"
                placeholder="Ingresa tus apellidos"
                clearInput="true">
              </ion-input>
              <div class="error-message" *ngIf="hasError('lastName')">
                {{ getErrorMessage('lastName') }}
              </div>
            </ion-item>

            <!-- Email -->
            <ion-item class="form-item" [class.error]="hasError('email')">
              <ion-icon name="mail-outline" slot="start" class="field-icon"></ion-icon>
              <ion-label position="stacked">Correo Electrónico *</ion-label>
              <ion-input 
                formControlName="email"
                type="email"
                placeholder="correo@ejemplo.com"
                clearInput="true">
              </ion-input>
              <div class="error-message" *ngIf="hasError('email')">
                {{ getErrorMessage('email') }}
              </div>
            </ion-item>

          </ion-list>
        </ion-card-content>
      </ion-card>

      <!-- Información Adicional -->
      <ion-card class="form-card">
        <ion-card-header>
          <ion-card-title>
            <ion-icon name="information-circle-outline" class="section-icon"></ion-icon>
            Información Adicional
          </ion-card-title>
        </ion-card-header>
        <ion-card-content>
          <ion-list>
            
            <!-- Teléfono -->
            <ion-item class="form-item" [class.error]="hasError('phone')">
              <ion-icon name="phone-portrait-outline" slot="start" class="field-icon"></ion-icon>
              <ion-label position="stacked">Teléfono *</ion-label>
              <ion-input 
                formControlName="phone"
                type="tel"
                placeholder="8712345678"
                maxlength="10"
                clearInput="true">
              </ion-input>
              <div class="error-message" *ngIf="hasError('phone')">
                {{ getErrorMessage('phone') }}
              </div>
            </ion-item>

            <!-- Contraseña -->
            <ion-item class="form-item" [class.error]="hasError('password')">
              <ion-icon name="lock-closed-outline" slot="start" class="field-icon"></ion-icon>
              <ion-label position="stacked">Nueva Contraseña (opcional)</ion-label>
              <ion-input 
                formControlName="password"
                type="password"
                placeholder="Mínimo 8 caracteres"
                clearInput="true">
              </ion-input>
              <div class="error-message" *ngIf="hasError('password')">
                {{ getErrorMessage('password') }}
              </div>
            </ion-item>

          </ion-list>
        </ion-card-content>
      </ion-card>

      <!-- Botones de Acción -->
      <div class="actions-section">
        <ion-button 
          expand="block" 
          type="submit"
          color="primary"
          size="large"
          [disabled]="isLoading"
          class="save-btn">
          <ion-icon name="save-outline" slot="start"></ion-icon>
          <span *ngIf="!isLoading">Guardar Cambios</span>
          <span *ngIf="isLoading">Guardando...</span>
        </ion-button>

        <ion-button 
          expand="block" 
          fill="outline"
          color="medium"
          size="large"
          (click)="cancelEdit()"
          [disabled]="isLoading"
          class="cancel-btn">
          Cancelar
        </ion-button>
      </div>

    </form>

  </div>
</ion-content>
