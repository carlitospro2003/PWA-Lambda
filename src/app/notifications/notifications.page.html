<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Notificaciones</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="markAllAsRead()" *ngIf="getUnreadCount() > 0">
        <ion-icon name="checkmark-circle-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="notifications-content">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Notificaciones</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="notifications-container">
    
    <!-- Pull to refresh -->
    <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
      <ion-refresher-content
        pulling-icon="refresh-outline"
        refreshing-spinner="circular"
        pulling-text="Desliza para actualizar..."
        refreshing-text="Actualizando...">
      </ion-refresher-content>
    </ion-refresher>

    <!-- Lista de notificaciones -->
    <div class="notifications-list">
      <ion-card 
        *ngFor="let notification of notifications; trackBy: trackByNotificationId"
        class="notification-card"
        [class.unread]="!notification.isRead"
        (click)="markAsRead(notification)">
        
        <ion-card-content>
          <div class="notification-content">
            
            <!-- Icono y indicador -->
            <div class="notification-icon-container">
              <ion-icon 
                [name]="getNotificationIcon(notification.type)" 
                [color]="getNotificationColor(notification.type)"
                class="notification-icon">
              </ion-icon>
              <div class="unread-indicator" *ngIf="!notification.isRead"></div>
            </div>

            <!-- Contenido principal -->
            <div class="notification-main">
              <div class="notification-header">
                <h3 class="notification-title">{{ notification.title }}</h3>
                <span class="notification-time">{{ formatTime(notification.timestamp) }}</span>
              </div>
              
              <p class="notification-message">{{ notification.message }}</p>
              
              <!-- Tipo de notificación -->
              <div class="notification-footer">
                <ion-badge 
                  [color]="getNotificationColor(notification.type)" 
                  size="small"
                  class="notification-badge">
                  {{ getNotificationTypeLabel(notification.type) }}
                </ion-badge>
              </div>
            </div>

            <!-- Acciones -->
            <div class="notification-actions">
              <ion-button 
                fill="clear" 
                size="small"
                (click)="deleteNotification(notification.id); $event.stopPropagation()">
                <ion-icon name="ellipsis-vertical-outline"></ion-icon>
              </ion-button>
            </div>

          </div>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- Estado vacío -->
    <div class="empty-state" *ngIf="notifications.length === 0">
      <ion-icon name="notifications-outline" class="empty-icon"></ion-icon>
      <h3>No tienes notificaciones</h3>
      <p>Cuando recibas nuevas notificaciones, aparecerán aquí</p>
    </div>

    <!-- Infinite scroll para cargar más -->
    <ion-infinite-scroll (ionInfinite)="loadMore($event)">
      <ion-infinite-scroll-content
        loading-spinner="bubbles"
        loading-text="Cargando más notificaciones...">
      </ion-infinite-scroll-content>
    </ion-infinite-scroll>

  </div>
</ion-content>